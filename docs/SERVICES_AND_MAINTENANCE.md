# 日语通网站：服务清单与续费/维护说明

## 一、网站使用的所有服务

| 类别 | 服务/组件 | 用途 | 当前使用情况 |
|------|-----------|------|--------------|
| **托管与网络** | 腾讯云轻量服务器 (Lighthouse) | 运行 Docker、Next.js 应用 | ✅ 已使用，IP 43.135.112.39 |
| | 域名 (nihongo-tool.cn) | 访问入口、HTTPS | ✅ 已配置 |
| | Nginx | 反向代理、HTTPS 终结 | ✅ 已配置 |
| | Let's Encrypt (Certbot) | 免费 SSL 证书 | ✅ 已配置，自动续期 |
| **数据与存储** | PostgreSQL | 用户、会话、激活码、订单等 | ✅ 必选（Neon/Vercel Postgres 等） |
| **AI 与能力** | OpenAI API | 中文翻译、单词解释、日语朗读(TTS) | ✅ 已使用 |
| | Cloudflare AI Gateway | 大陆访问 OpenAI 的代理 | ✅ 已使用（解决 403） |
| **可选能力** | Resend / SMTP | 邮箱验证码（当前已隐藏登录） | 可选 |
| | 阿里云短信 | 手机验证码（当前已隐藏登录） | 可选 |
| | 虎皮椒/讯虎支付 | 支付与回调 | 可选 |

---

## 二、需要定期续费、人工维护的项目

### 🔴 必须续费（到期会停服）

| 项目 | 周期 | 说明 | 建议 |
|------|------|------|------|
| **腾讯云轻量服务器** | 月付/年付 | 到期后服务器关机，网站无法访问 | 在腾讯云控制台设置**到期提醒**或**自动续费** |
| **域名 (nihongo-tool.cn)** | 按年 | 到期后域名可能被释放或无法解析 | 在腾讯云 DNSPod 设置**到期提醒**或**自动续费** |
| **PostgreSQL 数据库** | 视服务商而定 | 若用 Neon/Vercel Postgres 免费档，注意额度；付费档需按周期续费 | 确认当前套餐与续费方式，设日历提醒 |

### 🟠 按量付费 / 需保持余额（不会“到期”，但断供会影响功能）

| 项目 | 说明 | 建议 |
|------|------|------|
| **OpenAI API** | 按 token 计费，余额用尽则翻译/朗读/单词解释不可用 | 在 OpenAI 后台设**用量/预算告警**，定期查看账单 |
| **Cloudflare AI Gateway** | 有免费额度，超量可能限流或收费 | 在 Cloudflare Dashboard 关注用量 |

### 🟢 免费且自动维护（无需人工续费）

| 项目 | 说明 |
|------|------|
| **Let's Encrypt SSL 证书** | Certbot 已配置自动续期，一般无需人工操作 |
| **Nginx** | 随系统运行，无需续费 |
| **Docker / 应用镜像** | 一次性构建，无单独续费 |

### 🟡 可选服务（若启用则需关注）

| 项目 | 说明 |
|------|------|
| **Resend / SMTP** | 若启用邮箱验证码，需关注额度或套餐到期 |
| **阿里云短信** | 若启用手机验证码，需关注余额或套餐 |
| **虎皮椒/讯虎支付** | 若启用支付，需关注商户协议、费率与账户状态 |

---

## 三、建议的维护节奏

### 每月

- [ ] 看一眼 **腾讯云轻量** 是否即将到期（若未开自动续费）
- [ ] 看一眼 **OpenAI** 用量/余额，必要时充值

### 每年

- [ ] **域名** 到期前 1–2 个月续费（或确认自动续费已开启）
- [ ] 若数据库为付费套餐，确认 **PostgreSQL** 续费/续约
- [ ] 检查 **Cloudflare AI Gateway** 配额/政策是否有变化

### 按需

- [ ] 代码或 `.env` 变更后：在服务器上 `git pull`、`docker build`、重启容器
- [ ] 定期 `npm audit`、升级依赖，降低安全与兼容风险
- [ ] 确认数据库有备份（Neon/Vercel Postgres 等是否开启自动备份）

---

## 四、到期/断供影响一览

| 项目 | 到期/断供后现象 |
|------|------------------|
| 腾讯云轻量服务器 | 网站无法访问，需续费后开机 |
| 域名 | 无法通过 nihongo-tool.cn 访问，可能被他人注册 |
| PostgreSQL | 登录、激活码、数据读写失败，网站不可用 |
| OpenAI 余额用尽 | 翻译、单词解释、日语朗读不可用，假名注音仍可用 |
| Cloudflare 超限 | 同上（若完全依赖其代理 OpenAI） |
| SSL 证书 | 若自动续期失败，HTTPS 会报错，需人工检查 Certbot |

---

## 五、推荐设置（减少遗漏）

1. **腾讯云**
   - 轻量服务器：到期提醒 + 尽量开启自动续费
   - 域名：到期提醒 + 尽量开启自动续费

2. **OpenAI**
   - 设置 Billing 用量或预算告警，避免突然断用

3. **日历/待办**
   - 每年固定时间检查：域名、数据库、服务器续费与账单

4. **文档与密钥**
   - 将本文档与 `STACK_AND_RISKS.md` 放在一起，便于交接与自查
   - 所有 API Key、Token、SESSION_SECRET 仅放在 `.env`，定期备份并安全保管

---

**总结**：一段时间内**必须手动续费、需人工维护**的主要是：**腾讯云轻量服务器**、**域名 nihongo-tool.cn**、**PostgreSQL（若为付费）**；**OpenAI** 为按量付费需保持余额；**Let's Encrypt** 与 Nginx 为免费且自动/长期有效，只需偶尔确认证书续期成功即可。
