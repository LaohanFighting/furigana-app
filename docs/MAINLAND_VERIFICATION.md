# 大陆用户收不到验证码 — 原因与解决

## 现象

中国大陆用户使用**邮箱**登录时，点击「发送验证码」后收不到邮件，或邮件进入垃圾箱、延迟很久。

## 原因

1. **邮箱通道**
   - 若使用 **Resend**（海外服务）：发往 QQ/163/126 等国内邮箱时，容易被拦截、进垃圾箱或限流。
   - 若使用 **SMTP**（如 QQ 邮箱）：从腾讯云等服务器发信可能受端口或策略限制，且国内邮箱对「验证码」类邮件过滤较严。
2. **仅开放邮箱登录**：此前登录页只显示邮箱，大陆用户无法选择更稳定的手机验证码。

## 解决方案（推荐）

### 一、为大陆用户提供手机号登录 + 阿里云短信

1. **配置阿里云短信**（签名、模板、AccessKey），在服务器 `.env` 中设置：
   ```env
   ALIYUN_ACCESS_KEY_ID=你的AccessKeyId
   ALIYUN_ACCESS_KEY_SECRET=你的AccessKeySecret
   SMS_SIGN_NAME=你的短信签名
   SMS_TEMPLATE_CODE=你的验证码模板Code
   ```
   详细步骤见 [ALIYUN_SMS_SETUP.md](./ALIYUN_SMS_SETUP.md)、[ALIYUN_SMS_SIGN_TEMPLATE_GUIDE.md](./ALIYUN_SMS_SIGN_TEMPLATE_GUIDE.md)。

2. **登录页已恢复「手机登录」**：用户可选择「手机登录」并输入大陆手机号，验证码通过阿里云短信下发，到达率远高于邮箱。

3. 在登录页或站点说明中提示：**大陆用户建议使用手机号登录，验证码更稳定。**

### 二、仍使用邮箱时

- 若必须用邮箱：可尝试使用**国内企业邮箱 SMTP** 或已备案域名发信，并提醒用户检查垃圾箱、稍等几分钟。
- Resend 发往国内邮箱的到达率无法保证，不建议大陆用户仅依赖邮箱验证码。

## 小结

| 方式       | 大陆到达率 | 建议 |
|------------|------------|------|
| 手机号 + 阿里云短信 | 高         | 推荐，需配置签名/模板 |
| 邮箱（Resend）      | 低/不稳定   | 不推荐作为大陆主通道 |
| 邮箱（国内 SMTP）   | 一般       | 可作补充，提醒查垃圾箱 |

配置好阿里云短信并让用户使用「手机登录」后，大陆用户即可稳定收到验证码。
